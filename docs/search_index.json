[["index.html", "The Changing Shape of Empire: A GM Study of Chimú Bottles in Museum Collections Preface 0.1 Basis of inquiry 0.2 Primary findings 0.3 Acknowledgments 0.4 Funding 0.5 Data management 0.6 Colophon", " The Changing Shape of Empire: A GM Study of Chimú Bottles in Museum Collections R. Alan Covey, Robert Z. Selden Jr., Nicole Payntar, and Astrid Runggaldier 2023-01-05 Preface Reproducibility—the ability to recompute results—and replicability—the chances other experimenters will achieve a consistent result—are two foundational characteristics of successful scientific research (Leek and Peng 2015). 0.1 Basis of inquiry After centuries of looting along Peru’s North Coast, archaeologists acknowledge that the pottery of the Chimú Empire is one of the most collected Andean artifacts, but also one of the most poorly understood. Much of the enduring classificatory uncertainty comes from the problematic provenance of most Chimú vessels, and the fact that the distinctive blackware identified as Chimú represents the production of workshops from across an extensive area, during periods of regional political decentralization (c. 900-1200 CE), imperial growth (c. 1200-1450), and foreign conquest by the Inca (c. 1450-1535) and Spanish (after 1532) empires. This chapter builds on previous seriations and field observations, using geometric morphometric analysis of a sample of 3D-scanned Chimú bottles from publicly held collections at the University of Texas (Austin) and the American Museum of Natural History. Since Chimú bottles were formed in workshops using molds, variations in vessel shape can serve as indicators of variable practices. We compare a sample of typical Chimú blackware bottles with a sample of “Inca-Chimú” vessels that carry features typical of the short Inca occupation of the North Coast. Differences between the two samples offer new lines of evidence that can guide more precise classifications of these vessels, as well as new interpretations of the imperial history of Peru’s North Coast. 0.2 Primary findings 0.2.1 Linear metrics Bottles and jars differ significantly in orifice diameter Bottles and jars differ significantly in belly diameter Bottles and jars differ significantly in rim thickness Figure 0.1: Boxplots for vessel form by a, orifice diameter; b, base diameter; c, neck diameter; d, belly diameter; e, height; and f, rim thickness. 0.2.2 3D Geometric morphometrics Whole vessel morphology: Bottles and jars differ significantly in shape Bottles and jars do not differ in size # pca warp neck knitr::include_graphics(&#39;images/pca-warp-botjar.jpg&#39;) (#fig:pca.warp.botjar.index)Results of PCA summarising shape variation in bottles, gray; and jars, orange; with shapes + warp grids for maxima/minima of each axis. knitr::include_graphics(&#39;images/mshape.png&#39;) Figure 0.2: Mean shapes for bottles (a), jars (c), and comparison of bottle (gray) and jar (black) shape (b). Neck/rim morphology: Bottle and jar neck/rim shapes differ significantly Bottle and jar neck/rim sizes do not differ # pca warp neck knitr::include_graphics(&#39;images/pca-warp-neck.jpg&#39;) (#fig:pca.warp.ne.index)Results of PCA summarising shape variation in bottle necks/rims, gray; and jar necks/rims, orange; with shapes + warp grids for maxima/minima of each axis. knitr::include_graphics(&#39;images/mshape-neck.png&#39;) Figure 0.3: Mean shapes for bottle necks/rims (a), jar necks/rims (b), and comparison of bottle (gray) and jar (black) neck/rim shapes (c). Body/Base morphology: Bottle and jar body/base shapes do not differ Bottle and jar body/base sizes do not differ 0.3 Acknowledgments We extend our gratitude to… 0.4 Funding Components of this analytical work flow were developed and funded by a Preservation Technology and Training grant (P14AP00138) to RZS from the National Center for Preservation Technology and Training (NCPTT), and additional grants to RZS from the Caddo Tribe of Oklahoma and the National Forests and Grasslands in Texas (15-PA-11081300-033 and 20-PA-11081300-074). Funding to scan the Chimú vessels in the Art and Art History Collections at The University of Texas at Austin was provided by The University of Texas at Austin. 0.5 Data management All data and analysis code associated with this project can be accessed through this document or the GitHub repository, which is digitally curated on the Open Science Framework (DOI 10.17605/OSF.IO/VZHJR). The reproducible nature of this undertaking provides a means for others to critically assess and evaluate the various analyses (Gray and Marwick 2019; Peng 2011; Gandrud 2014), which is a necessary requirement for the production of reliable knowledge. Reproducibility projects in psychology and cancer biology are impacting current research practices across all domains. Examples of reproducible research are becoming more abundant in archaeology (Marwick 2016; Ivanovaite et al. 2020; Selden Jr., Dockall, and Dubied 2020), and the next generation of archaeologists are learning those tools and methods needed to reproduce and/or replicate research results (Marwick et al. 2019). Reproducible and replicable research work flows are often employed at the highest levels of humanities-based inquiries to mitigate concern or doubt regarding proper execution, and is of particular import should the results have—explicitly or implicitly—a major impact on scientific progress (Peels and Bouter 2018). 0.6 Colophon This version of the analysis was generated on 2023-01-05 11:16:17 using the following computational environment and dependencies: # what R packages and versions were used? if (&quot;devtools&quot; %in% installed.packages()) devtools::session_info() ## ─ Session info ────────────────────────────────────────────────────────────────────────────────────────────────────── ## setting value ## version R version 4.2.2 (2022-10-31 ucrt) ## os Windows 10 x64 (build 19045) ## system x86_64, mingw32 ## ui RStudio ## language (EN) ## collate English_United States.utf8 ## ctype English_United States.utf8 ## tz America/Chicago ## date 2023-01-05 ## rstudio 2022.12.0+353 Elsbeth Geranium (desktop) ## pandoc 2.19.2 @ C:/Program Files/RStudio/resources/app/bin/quarto/bin/tools/ (via rmarkdown) ## ## ─ Packages ────────────────────────────────────────────────────────────────────────────────────────────────────────── ## package * version date (UTC) lib source ## abind 1.4-5 2016-07-21 [1] CRAN (R 4.2.0) ## ape 5.6-2 2022-03-02 [1] CRAN (R 4.2.2) ## assertthat 0.2.1 2019-03-21 [1] CRAN (R 4.2.2) ## backports 1.4.1 2021-12-13 [1] CRAN (R 4.2.0) ## bookdown 0.31 2022-12-13 [1] CRAN (R 4.2.2) ## broom 1.0.2 2022-12-15 [1] CRAN (R 4.2.2) ## bslib 0.4.2 2022-12-16 [1] CRAN (R 4.2.2) ## cachem 1.0.6 2021-08-19 [1] CRAN (R 4.2.2) ## callr 3.7.3 2022-11-02 [1] CRAN (R 4.2.2) ## car 3.1-1 2022-10-19 [1] CRAN (R 4.2.2) ## carData 3.0-5 2022-01-06 [1] CRAN (R 4.2.2) ## cellranger 1.1.0 2016-07-27 [1] CRAN (R 4.2.2) ## cli 3.4.1 2022-09-23 [1] CRAN (R 4.2.2) ## cluster * 2.1.4 2022-08-22 [2] CRAN (R 4.2.2) ## colorspace 2.0-3 2022-02-21 [1] CRAN (R 4.2.2) ## cowplot 1.1.1 2020-12-30 [1] CRAN (R 4.2.2) ## crayon 1.5.2 2022-09-29 [1] CRAN (R 4.2.2) ## DBI 1.1.3 2022-06-18 [1] CRAN (R 4.2.2) ## dbplyr 2.2.1 2022-06-27 [1] CRAN (R 4.2.2) ## devtools 2.4.5 2022-10-11 [1] CRAN (R 4.2.2) ## digest 0.6.31 2022-12-11 [1] CRAN (R 4.2.2) ## dplyr * 1.0.10 2022-09-01 [1] CRAN (R 4.2.2) ## ellipsis 0.3.2 2021-04-29 [1] CRAN (R 4.2.2) ## evaluate 0.19 2022-12-13 [1] CRAN (R 4.2.2) ## fansi 1.0.3 2022-03-24 [1] CRAN (R 4.2.2) ## farver 2.1.1 2022-07-06 [1] CRAN (R 4.2.2) ## fastmap 1.1.0 2021-01-25 [1] CRAN (R 4.2.2) ## forcats * 0.5.2 2022-08-19 [1] CRAN (R 4.2.2) ## fs 1.5.2 2021-12-08 [1] CRAN (R 4.2.2) ## gargle 1.2.1 2022-09-08 [1] CRAN (R 4.2.2) ## generics 0.1.3 2022-07-05 [1] CRAN (R 4.2.2) ## ggExtra * 0.10.0 2022-03-23 [1] CRAN (R 4.2.2) ## ggfortify * 0.4.15 2022-11-11 [1] CRAN (R 4.2.2) ## ggplot2 * 3.4.0 2022-11-04 [1] CRAN (R 4.2.2) ## ggpubr * 0.5.0 2022-11-16 [1] CRAN (R 4.2.2) ## ggsignif 0.6.4 2022-10-13 [1] CRAN (R 4.2.2) ## glue 1.6.2 2022-02-24 [1] CRAN (R 4.2.2) ## googledrive 2.0.0 2021-07-08 [1] CRAN (R 4.2.2) ## googlesheets4 1.0.1 2022-08-13 [1] CRAN (R 4.2.2) ## gridExtra 2.3 2017-09-09 [1] CRAN (R 4.2.2) ## gtable 0.3.1 2022-09-01 [1] CRAN (R 4.2.2) ## haven 2.5.1 2022-08-22 [1] CRAN (R 4.2.2) ## here * 1.0.1 2020-12-13 [1] CRAN (R 4.2.2) ## highr 0.10 2022-12-22 [1] CRAN (R 4.2.2) ## hms 1.1.2 2022-08-19 [1] CRAN (R 4.2.2) ## htmltools 0.5.4 2022-12-07 [1] CRAN (R 4.2.2) ## htmlwidgets 1.6.0 2022-12-15 [1] CRAN (R 4.2.2) ## httpuv 1.6.7 2022-12-14 [1] CRAN (R 4.2.2) ## httr 1.4.4 2022-08-17 [1] CRAN (R 4.2.2) ## jquerylib 0.1.4 2021-04-26 [1] CRAN (R 4.2.2) ## jsonlite 1.8.4 2022-12-06 [1] CRAN (R 4.2.2) ## knitr 1.41 2022-11-18 [1] CRAN (R 4.2.2) ## labeling 0.4.2 2020-10-20 [1] CRAN (R 4.2.0) ## later 1.3.0 2021-08-18 [1] CRAN (R 4.2.2) ## lattice * 0.20-45 2021-09-22 [2] CRAN (R 4.2.2) ## lifecycle 1.0.3 2022-10-07 [1] CRAN (R 4.2.2) ## lubridate 1.9.0 2022-11-06 [1] CRAN (R 4.2.2) ## magrittr 2.0.3 2022-03-30 [1] CRAN (R 4.2.2) ## MASS 7.3-58.1 2022-08-03 [2] CRAN (R 4.2.2) ## Matrix 1.5-1 2022-09-13 [2] CRAN (R 4.2.2) ## memoise 2.0.1 2021-11-26 [1] CRAN (R 4.2.2) ## mgcv 1.8-41 2022-10-21 [2] CRAN (R 4.2.2) ## mime 0.12 2021-09-28 [1] CRAN (R 4.2.0) ## miniUI 0.1.1.1 2018-05-18 [1] CRAN (R 4.2.2) ## modelr 0.1.10 2022-11-11 [1] CRAN (R 4.2.2) ## munsell 0.5.0 2018-06-12 [1] CRAN (R 4.2.2) ## nlme 3.1-160 2022-10-10 [2] CRAN (R 4.2.2) ## permute * 0.9-7 2022-01-27 [1] CRAN (R 4.2.2) ## pillar 1.8.1 2022-08-19 [1] CRAN (R 4.2.2) ## pkgbuild 1.4.0 2022-11-27 [1] CRAN (R 4.2.2) ## pkgconfig 2.0.3 2019-09-22 [1] CRAN (R 4.2.2) ## pkgload 1.3.2 2022-11-16 [1] CRAN (R 4.2.2) ## prettyunits 1.1.1 2020-01-24 [1] CRAN (R 4.2.2) ## processx 3.8.0 2022-10-26 [1] CRAN (R 4.2.2) ## profvis 0.3.7 2020-11-02 [1] CRAN (R 4.2.2) ## promises 1.2.0.1 2021-02-11 [1] CRAN (R 4.2.2) ## ps 1.7.2 2022-10-26 [1] CRAN (R 4.2.2) ## purrr * 1.0.0 2022-12-20 [1] CRAN (R 4.2.2) ## R6 2.5.1 2021-08-19 [1] CRAN (R 4.2.2) ## Rcpp 1.0.9 2022-07-08 [1] CRAN (R 4.2.1) ## readr * 2.1.3 2022-10-01 [1] CRAN (R 4.2.2) ## readxl 1.4.1 2022-08-17 [1] CRAN (R 4.2.2) ## remotes 2.4.2 2021-11-30 [1] CRAN (R 4.2.2) ## reprex 2.0.2 2022-08-17 [1] CRAN (R 4.2.2) ## rlang 1.0.6 2022-09-24 [1] CRAN (R 4.2.2) ## rmarkdown 2.19 2022-12-15 [1] CRAN (R 4.2.2) ## rpart * 4.1.19 2022-10-21 [1] CRAN (R 4.2.2) ## rpart.plot * 3.1.1 2022-05-21 [1] CRAN (R 4.2.2) ## rprojroot 2.0.3 2022-04-02 [1] CRAN (R 4.2.2) ## RRPP * 1.3.1.999 2022-09-12 [1] Github (mlcollyer/RRPP@7a60a15) ## rstatix 0.7.1 2022-11-09 [1] CRAN (R 4.2.2) ## rstudioapi 0.14 2022-08-22 [1] CRAN (R 4.2.2) ## RVAideMemoire * 0.9-81-2 2022-02-21 [1] CRAN (R 4.2.2) ## rvest 1.0.3 2022-08-19 [1] CRAN (R 4.2.2) ## sass 0.4.4 2022-11-24 [1] CRAN (R 4.2.2) ## scales 1.2.1 2022-08-20 [1] CRAN (R 4.2.2) ## sessioninfo 1.2.2 2021-12-06 [1] CRAN (R 4.2.2) ## shiny 1.7.4 2022-12-15 [1] CRAN (R 4.2.2) ## stringi 1.7.8 2022-07-11 [1] CRAN (R 4.2.1) ## stringr * 1.5.0 2022-12-02 [1] CRAN (R 4.2.2) ## tibble * 3.1.8 2022-07-22 [1] CRAN (R 4.2.2) ## tidyr * 1.2.1 2022-09-08 [1] CRAN (R 4.2.2) ## tidyselect 1.2.0 2022-10-10 [1] CRAN (R 4.2.2) ## tidyverse * 1.3.2 2022-07-18 [1] CRAN (R 4.2.2) ## timechange 0.1.1 2022-11-04 [1] CRAN (R 4.2.2) ## tzdb 0.3.0 2022-03-28 [1] CRAN (R 4.2.2) ## urlchecker 1.0.1 2021-11-30 [1] CRAN (R 4.2.2) ## usethis 2.1.6 2022-05-25 [1] CRAN (R 4.2.2) ## utf8 1.2.2 2021-07-24 [1] CRAN (R 4.2.2) ## vctrs 0.5.1 2022-11-16 [1] CRAN (R 4.2.2) ## vegan * 2.6-4 2022-10-11 [1] CRAN (R 4.2.2) ## wesanderson * 0.3.6 2018-04-20 [1] CRAN (R 4.2.2) ## withr 2.5.0 2022-03-03 [1] CRAN (R 4.2.2) ## xfun 0.36 2022-12-21 [1] CRAN (R 4.2.2) ## xml2 1.3.3 2021-11-30 [1] CRAN (R 4.2.2) ## xtable 1.8-4 2019-04-21 [1] CRAN (R 4.2.2) ## yaml 2.3.6 2022-10-18 [1] CRAN (R 4.2.1) ## ## [1] C:/Users/seldenjrz/AppData/Local/R/win-library/4.2 ## [2] C:/Program Files/R/R-4.2.2/library ## ## ───────────────────────────────────────────────────────────────────────────────────────────────────────────────────── Current Git commit details are: # where can I find this commit? if (&quot;git2r&quot; %in% installed.packages() &amp; git2r::in_repository(path = &quot;.&quot;)) git2r::repository(here::here()) ## Local: main D:/github/peru.bottle.jar ## Remote: main @ origin (https://github.com/seldenlab/peru.bottle.jar) ## Head: [0cdc143] 2022-11-09: &lt;edit ms&gt; References "],["linear-chimú-vessel-metrics.html", "Chapter 1 Linear Chimú vessel metrics 1.1 Load DATA + define variables 1.2 Boxplots for variable by group 1.3 Principal Components Analysis for group 1.4 MANOVA", " Chapter 1 Linear Chimú vessel metrics # load libraries library(here) library(tidyverse) library(vegan) library(RVAideMemoire) library(ggpubr) library(ggfortify) library(cluster) library(wesanderson) library(ggExtra) 1.1 Load DATA + define variables DATA &lt;- read.csv(&quot;potmeas.csv&quot;, header = TRUE, as.is = TRUE) # define variables od &lt;- DATA$od &lt;- DATA$orifice.diameter # orifice diameter bd &lt;- DATA$bd &lt;- DATA$base.diameter # base diameter nd &lt;- DATA$nd &lt;- DATA$bneck.diameter # neck diameter bl &lt;- DATA$bl &lt;- DATA$wide.diameter # belly diameter h &lt;- DATA$h &lt;- DATA$height # height RT &lt;- DATA$RT &lt;- DATA$rim.thickness # rim thickness gp &lt;- DATA$gp &lt;- as.factor(DATA$form) # bottle or jar 1.2 Boxplots for variable by group # boxplot of orifice diameter ~ group odgroup &lt;- ggplot(DATA, aes(x = gp, y = od, color = gp)) + geom_boxplot() + geom_dotplot(binaxis = &#39;y&#39;,stackdir = &#39;center&#39;,dotsize = 0.3) + scale_colour_manual(values = wes_palette(&quot;Moonrise2&quot;)) + labs(x = &quot;Form&quot;, y = &quot;Orifice Diam&quot;) + theme(legend.position = &quot;none&quot;) # boxplot of base diameter ~ group bdgroup &lt;- ggplot(DATA, aes(x = gp, y = bd, color = gp)) + geom_boxplot() + geom_dotplot(binaxis = &#39;y&#39;,stackdir = &#39;center&#39;,dotsize = 0.3) + scale_colour_manual(values = wes_palette(&quot;Moonrise2&quot;)) + labs(x = &quot;Form&quot;, y = &quot;Base Diam&quot;) + theme(legend.position = &quot;none&quot;) # boxplot of neck diameter ~ group ndgroup &lt;- ggplot(DATA, aes(x = gp, y = nd, color = gp)) + geom_boxplot() + geom_dotplot(binaxis = &#39;y&#39;,stackdir = &#39;center&#39;,dotsize = 0.3) + scale_colour_manual(values = wes_palette(&quot;Moonrise2&quot;)) + labs(x = &quot;Form&quot;, y = &quot;Neck Diam&quot;) + theme(legend.position = &quot;none&quot;) # boxplot of belly diameter ~ group blgroup &lt;- ggplot(DATA, aes(x = gp, y = bl, color = gp)) + geom_boxplot() + geom_dotplot(binaxis = &#39;y&#39;,stackdir = &#39;center&#39;,dotsize = 0.3) + scale_colour_manual(values = wes_palette(&quot;Moonrise2&quot;)) + labs(x = &quot;Form&quot;, y = &quot;Belly Diam&quot;) + theme(legend.position = &quot;none&quot;) # boxplot of height ~ group hgroup &lt;- ggplot(DATA, aes(x = gp, y = h, color = gp)) + geom_boxplot() + geom_dotplot(binaxis = &#39;y&#39;,stackdir = &#39;center&#39;,dotsize = 0.3) + scale_colour_manual(values = wes_palette(&quot;Moonrise2&quot;)) + labs(x = &quot;Form&quot;, y = &quot;Height&quot;) + theme(legend.position = &quot;none&quot;) # boxplot of rim thickness ~ group rtgroup &lt;- ggplot(DATA, aes(x = gp, y = RT, color = gp)) + geom_boxplot() + geom_dotplot(binaxis = &#39;y&#39;,stackdir = &#39;center&#39;,dotsize = 0.3) + scale_colour_manual(values = wes_palette(&quot;Moonrise2&quot;)) + labs(x = &quot;Form&quot;, y = &quot;Rim Thick&quot;) + theme(legend.position = &quot;none&quot;) # render figure sitefigure&lt;-ggarrange(odgroup, bdgroup, ndgroup, blgroup, hgroup, rtgroup, labels = c(&quot;b&quot;,&quot;c&quot;,&quot;d&quot;,&quot;e&quot;,&quot;f&quot;,&quot;g&quot;), ncol = 3, nrow = 2) ## Bin width defaults to 1/30 of the range of the data. Pick better value with `binwidth`. ## Bin width defaults to 1/30 of the range of the data. Pick better value with `binwidth`. ## Bin width defaults to 1/30 of the range of the data. Pick better value with `binwidth`. ## Bin width defaults to 1/30 of the range of the data. Pick better value with `binwidth`. ## Bin width defaults to 1/30 of the range of the data. Pick better value with `binwidth`. ## Bin width defaults to 1/30 of the range of the data. Pick better value with `binwidth`. sitefigure Figure 1.1: Boxplots of orifice diameter, base diameter, neck diameter, belly diameter, height, and rim thickness for the anthropomorphic, phytomorphic, and zoomorphic Chimú vessels used in this study. 1.3 Principal Components Analysis for group # set plot parameters to plot by group df &lt;- DATA[c(3:8)] pch.gps &lt;- c(15,17)[as.factor(gp)] col.gps &lt;- wes_palette(&quot;Moonrise2&quot;)[as.factor(gp)] ## pca plot pca &lt;- autoplot(prcomp(df), data = DATA, asp = 1, shape = pch.gps, colour = &quot;form&quot;, variance_percentage = TRUE, loadings = TRUE, loadings.colour = &#39;blue&#39;, loadings.label = TRUE, loadings.label.size = 3, frame = TRUE, frame.type = &#39;t&#39;) + scale_fill_manual(values = wes_palette(&quot;Moonrise2&quot;)) + scale_colour_manual(values = wes_palette(&quot;Moonrise2&quot;)) ggMarginal(pca, groupColour = TRUE) Figure 1.2: Results of Principal Components Analysis for linear metrics associated with the Chimu vessels used in this study (gray squares, anthropomorphic; orange triangles, phytomorphic; tan circles, zoomorphic). 1.4 MANOVA # perMANOVA ceramic.matrix &lt;- as.matrix(DATA[,3:8]) # response vars ceramic.mat &lt;- sqrt(ceramic.matrix) # sqrt transform ceramic.dist &lt;- vegdist(ceramic.mat, method = &#39;bray&#39;) # dissimilarity matrix set.seed(5) # make results reproducible # model: morphology as a function of form (jar v. bottle) ceramic.manova &lt;- adonis2(ceramic.dist ~ form, data = DATA, permutations = 10000, method = &#39;bray&#39;) ## do bottles and jars differ? ceramic.manova ## Permutation test for adonis under reduced model ## Terms added sequentially (first to last) ## Permutation: free ## Number of permutations: 10000 ## ## adonis2(formula = ceramic.dist ~ form, data = DATA, permutations = 10000, method = &quot;bray&quot;) ## Df SumOfSqs R2 F Pr(&gt;F) ## form 1 0.011429 0.10565 4.4889 0.007699 ** ## Residual 38 0.096751 0.89435 ## Total 39 0.108180 1.00000 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 "],["landmarking-protocol.html", "Chapter 2 Landmarking protocol", " Chapter 2 Landmarking protocol "],["bottle-vs-jar-morphology.html", "Chapter 3 Bottle vs Jar morphology 3.1 Load packages + data 3.2 Generalised Procrustes Analysis 3.3 Principal Components Analysis 3.4 Vessel size and shape 3.5 Morphological disparity 3.6 Mean shapes", " Chapter 3 Bottle vs Jar morphology 3.1 Load packages + data # load packages #devtools::install_github(&quot;mlcollyer/RRPP&quot;) #devtools::install_github(&quot;geomorphR/geomorph&quot;, ref = &quot;Stable&quot;, build_vignettes = TRUE) library(here) library(geomorph) ## Loading required package: rgl ## Loading required package: Matrix ## ## Attaching package: &#39;Matrix&#39; ## The following objects are masked from &#39;package:tidyr&#39;: ## ## expand, pack, unpack library(tidyverse) library(wesanderson) # read GM data source(&#39;readmulti.csv.R&#39;) setwd(&quot;./data&quot;) filelist &lt;- list.files(pattern = &quot;.csv&quot;) coords &lt;- readmulti.csv(filelist) setwd(&quot;../&quot;) # read qualitative data qdata &lt;- read.csv(&quot;qdata.csv&quot;, header = TRUE, row.names = 1) qdata &lt;- qdata[match(dimnames(coords)[[3]], rownames(qdata)),] 3.2 Generalised Procrustes Analysis Landmark data were aligned to a global coordinate system (Kendall 1981, 1984; Slice 2001), achieved through generalised Procrustes superimposition (Rohlf and Slice 1990) performed in R 4.0.3 (R Core Development Team, 2020) using the geomorph library v. 3.3.2 (Adams et al. 2017; Adams and Otárola-Castillo 2013). Procrustes superimposition translates, scales, and rotates the coordinate data to allow for comparisons among objects (Gower 1975; Rohlf and Slice 1990). The geomorph package uses a partial Procrustes superimposition that projects the aligned specimens into tangent space subsequent to alignment in preparation for the use of multivariate methods that assume linear space (Rohlf 1999; Slice 2001). # gpa Y.gpa &lt;- gpagen(coords, PrinAxes = TRUE, ProcD = TRUE, Proj = TRUE, print.progress = FALSE) # geomorph data frame gdf &lt;- geomorph.data.frame(shape = Y.gpa$coords, size = Y.gpa$Csize, type = qdata$type) # render 3d gpa plot plot(Y.gpa) # gpa plot #knitr::include_graphics(&#39;images/gpa3d.png&#39;) # add centroid size to qdata qdata$csz &lt;- Y.gpa$Csize # print updated qdata with centroid size knitr::kable(qdata, align = &quot;lccccc&quot;, caption = &quot;Modified attributes included in qdata.&quot;) Table 3.1: Modified attributes included in qdata. group type csz 1608101 phytomorph bottle 480.3691 1608102 phytomorph bottle 642.7924 1608111 anthropomorph jar 585.9878 1608121 phytomorph jar 673.7326 1608122 zoomorph bottle 578.2339 1608124 zoomorph bottle 543.0810 1608125 zoomorph bottle 538.4608 1608126 zoomorph jar 613.1277 1608129 zoomorph jar 511.8743 1608131 zoomorph jar 681.0963 1608140 zoomorph bottle 558.2951 1608141 anthropomorph bottle 511.1698 1608163 zoomorph jar 432.3418 160836 phytomorph bottle 509.1797 160839 zoomorph jar 416.4591 160844 anthropomorph jar 607.4952 160846 zoomorph bottle 545.1291 160847 anthropomorph bottle 416.4516 160848 anthropomorph jar 468.6945 160849 anthropomorph bottle 453.0625 160850 anthropomorph bottle 751.5635 160852 zoomorph bottle 512.1550 160852x anthropomorph jar 596.2446 160859 zoomorph bottle 512.3332 160860 anthropomorph jar 449.6768 160868 zoomorph bottle 674.0455 160873 anthropomorph jar 590.1911 160875 anthropomorph bottle 687.1416 160876 anthropomorph bottle 591.4190 160881 anthropomorph jar 416.0126 160882 zoomorph bottle 544.4697 160884 zoomorph jar 418.5339 160886 zoomorph bottle 441.5053 160888 anthropomorph bottle 379.4152 160892 anthropomorph jar 384.3096 205854 anthropomorph bottle 407.5996 206614 zoomorph jar 458.8122 238944 phytomorph bottle 701.0724 PEX35 zoomorph bottle 635.8740 3.2.1 Boxplot # attributes for boxplot csz &lt;- qdata$csz group &lt;- qdata$group type &lt;- qdata$type # boxplot of vessel centroid size by type csz.type &lt;- ggplot(qdata, aes(x = type, y = csz, color = type)) + geom_boxplot() + geom_dotplot(binaxis = &#39;y&#39;, stackdir = &#39;center&#39;, dotsize = 0.3) + scale_colour_manual(values = wes_palette(&quot;Moonrise2&quot;)) + theme(legend.position = &quot;none&quot;) + labs(x = &#39;Group&#39;, y = &#39;Centroid Size&#39;) # render plot csz.type ## Bin width defaults to 1/30 of the range of the data. Pick better value with `binwidth`. Figure 3.1: Boxplot of centroid size by spatial/temporal unit. 3.3 Principal Components Analysis Principal components analysis (Jolliffe 2002) was used to visualise shape variation among the bottles. The shape changes described by each principal axis are commonly visualised using thin-plate spline warping of a reference 3D mesh (Klingenberg 2013; Sherratt et al. 2014). # principal components analysis pca&lt;-gm.prcomp(Y.gpa$coords) summary(pca) ## ## Ordination type: Principal Component Analysis ## Centering by OLS mean ## Orthogonal projection of OLS residuals ## Number of observations: 39 ## Number of vectors 38 ## ## Importance of Components: ## Comp1 Comp2 Comp3 Comp4 Comp5 Comp6 Comp7 ## Eigenvalues 0.004485678 0.00355943 0.001311864 0.0007823485 0.0003097816 0.0002256185 8.118173e-05 ## Proportion of Variance 0.406257479 0.32236931 0.118812527 0.0708554894 0.0280562002 0.0204337408 7.352442e-03 ## Cumulative Proportion 0.406257479 0.72862679 0.847439320 0.9182948099 0.9463510100 0.9667847509 9.741372e-01 ## Comp8 Comp9 Comp10 Comp11 Comp12 Comp13 Comp14 ## Eigenvalues 6.638848e-05 4.706338e-05 3.716778e-05 3.008759e-05 2.036059e-05 0.0000186112 1.408432e-05 ## Proportion of Variance 6.012651e-03 4.262421e-03 3.366200e-03 2.724964e-03 1.844011e-03 0.0016855733 1.275584e-03 ## Cumulative Proportion 9.801498e-01 9.844123e-01 9.877785e-01 9.905034e-01 9.923474e-01 0.9940330135 9.953086e-01 ## Comp15 Comp16 Comp17 Comp18 Comp19 Comp20 Comp21 ## Eigenvalues 9.551946e-06 8.672174e-06 5.912122e-06 4.837964e-06 4.597733e-06 3.331368e-06 2.538962e-06 ## Proportion of Variance 8.650976e-04 7.854188e-04 5.354472e-04 4.381632e-04 4.164060e-04 3.017143e-04 2.299479e-04 ## Cumulative Proportion 9.961737e-01 9.969591e-01 9.974946e-01 9.979327e-01 9.983491e-01 9.986508e-01 9.988808e-01 ## Comp22 Comp23 Comp24 Comp25 Comp26 Comp27 Comp28 ## Eigenvalues 2.282581e-06 1.870651e-06 1.447943e-06 1.205523e-06 1.143831e-06 8.552530e-07 7.657932e-07 ## Proportion of Variance 2.067281e-04 1.694205e-04 1.311368e-04 1.091814e-04 1.035942e-04 7.745829e-05 6.935612e-05 ## Cumulative Proportion 9.990875e-01 9.992569e-01 9.993881e-01 9.994973e-01 9.996009e-01 9.996783e-01 9.997477e-01 ## Comp29 Comp30 Comp31 Comp32 Comp33 Comp34 Comp35 ## Eigenvalues 5.817632e-07 5.406710e-07 4.100172e-07 3.589511e-07 3.052523e-07 2.062271e-07 1.804861e-07 ## Proportion of Variance 5.268894e-05 4.896732e-05 3.713431e-05 3.250937e-05 2.764599e-05 1.867752e-05 1.634620e-05 ## Cumulative Proportion 9.998004e-01 9.998493e-01 9.998865e-01 9.999190e-01 9.999466e-01 9.999653e-01 9.999816e-01 ## Comp36 Comp37 Comp38 ## Eigenvalues 1.320782e-07 6.797149e-08 2.696693e-09 ## Proportion of Variance 1.196202e-05 6.156020e-06 2.442333e-07 ## Cumulative Proportion 9.999936e-01 9.999998e-01 1.000000e+00 # set plot parameters (types) pch.gps.type &lt;- c(15,17)[as.factor(type)] col.gps.type &lt;- wes_palette(&quot;Moonrise2&quot;)[as.factor(type)] col.hull.type &lt;- c(&quot;#798E87&quot;,&quot;#C27D38&quot;) # plot pca by comb pc.plot.type &lt;- plot(pca, asp = 1, pch = pch.gps.type, col = col.gps.type) shapeHulls(pc.plot.type, groups = type, group.cols = col.hull.type) 3.3.1 Minima/maxima of PC1/2 with warp grids # plot x/y maxima/minima ## x - minima ref &lt;- mean.shape &lt;- mshape(Y.gpa$coords) plotRefToTarget(M1 = ref, M2 = pca$shapes$shapes.comp1$min, method = &quot;TPS&quot;) plotRefToTarget(M1 = ref, M2 = pca$shapes$shapes.comp1$max, method = &quot;TPS&quot;) plotRefToTarget(M1 = ref, M2 = pca$shapes$shapes.comp2$min, method = &quot;TPS&quot;) plotRefToTarget(M1 = ref, M2 = pca$shapes$shapes.comp2$max, method = &quot;TPS&quot;) # pca warp knitr::include_graphics(&#39;images/pca-warp-botjar.jpg&#39;) (#fig:pca.warp.botjar)Results of PCA summarising shape variation in bottles, gray; and jars, orange; with shapes + warp grids for maxima/minima of each axis. 3.4 Vessel size and shape A residual randomisation permutation procedure (RRPP; n = 10,000 permutations) was used for all Procrustes ANOVAs (Adams and Collyer 2015; Michael L. Collyer and Adams 2018), which has higher statistical power and a greater ability to identify patterns in the data should they be present (Anderson and Ter Braak 2003). To assess whether shape changes differ by group (geography and time), Procrustes ANOVAs (Goodall 1991) were also run that enlist effect-sizes (zscores) computed as standard deviates of the generated sampling distributions (M. L. Collyer, Sekora, and Adams 2015). # size as a function of vessel form (bottle/jar)? fit.size.type &lt;- procD.lm(size ~ type, data = gdf, print.progress = FALSE, iter = 9999) # Procrustes ANOVA: do sizes differ as a function of vessel form? anova(fit.size.type) ## ## Analysis of Variance, using Residual Randomization ## Permutation procedure: Randomization of null model residuals ## Number of permutations: 10000 ## Estimation method: Ordinary Least Squares ## Sums of Squares and Cross-products: Type I ## Effect sizes (Z) based on F distributions ## ## Df SS MS Rsq F Z Pr(&gt;F) ## type 1 8175 8174.6 0.02185 0.8265 0.38392 0.3671 ## Residuals 37 365954 9890.6 0.97815 ## Total 38 374128 ## ## Call: procD.lm(f1 = size ~ type, iter = 9999, data = gdf, print.progress = FALSE) # shape as a function of vessel form? fit.shape.type &lt;- procD.lm(shape ~ type, data = gdf, print.progress = FALSE, iter = 9999) # Procrustes ANOVA: do shapes differ as a function of vessel form? anova(fit.shape.type) ## ## Analysis of Variance, using Residual Randomization ## Permutation procedure: Randomization of null model residuals ## Number of permutations: 10000 ## Estimation method: Ordinary Least Squares ## Sums of Squares and Cross-products: Type I ## Effect sizes (Z) based on F distributions ## ## Df SS MS Rsq F Z Pr(&gt;F) ## type 1 0.03535 0.035351 0.08426 3.4043 2.1661 0.0135 * ## Residuals 37 0.38422 0.010384 0.91574 ## Total 38 0.41958 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Call: procD.lm(f1 = shape ~ type, iter = 9999, data = gdf, print.progress = FALSE) 3.5 Morphological disparity # morphological disparity: do either of the groups display greater # size variation among individuals relative to the other group? morphol.disparity(fit.size.type, groups = qdata$type, data = gdf, print.progress = FALSE, iter = 9999) ## ## Call: ## morphol.disparity(f1 = fit.size.type, groups = qdata$type, iter = 9999, data = gdf, print.progress = FALSE) ## ## ## ## Randomized Residual Permutation Procedure Used ## 10000 Permutations ## ## Procrustes variances for defined groups ## bottle jar ## 9375.973 9394.149 ## ## ## Pairwise absolute differences between variances ## bottle jar ## bottle 0.0000 18.1761 ## jar 18.1761 0.0000 ## ## ## P-Values ## bottle jar ## bottle 1.0000 0.9949 ## jar 0.9949 1.0000 # morphological disparity: do either of the groups display greater #shape variation among individuals relative to the other group? morphol.disparity(fit.shape.type, groups = qdata$type, data = gdf, print.progress = FALSE, iter = 9999) ## ## Call: ## morphol.disparity(f1 = fit.shape.type, groups = qdata$type, iter = 9999, data = gdf, print.progress = FALSE) ## ## ## ## Randomized Residual Permutation Procedure Used ## 10000 Permutations ## ## Procrustes variances for defined groups ## bottle jar ## 0.01168155 0.00722178 ## ## ## Pairwise absolute differences between variances ## bottle jar ## bottle 0.000000000 0.004459774 ## jar 0.004459774 0.000000000 ## ## ## P-Values ## bottle jar ## bottle 1.0000 0.3953 ## jar 0.3953 1.0000 3.6 Mean shapes # subset landmark coordinates to produce mean shapes new.coords&lt;-coords.subset(A = Y.gpa$coords, group = qdata$type) names(new.coords) ## [1] &quot;bottle&quot; &quot;jar&quot; # group shape means mean &lt;- lapply(new.coords, mshape) # plot mean shapes (type) plot(mean$bottle) plot(mean$jar) # comparison plots plotRefToTarget(mean$bottle, mean$jar, method = c(&quot;points&quot;), mag = 1) knitr::include_graphics(&#39;images/mshape.png&#39;) References "],["dgm-neck-morphology.html", "Chapter 4 3DGM: Neck morphology 4.1 Load packages + data 4.2 Generalised Procrustes Analysis 4.3 Principal Components Analysis 4.4 Neck size and shape 4.5 Mean shapes", " Chapter 4 3DGM: Neck morphology 4.1 Load packages + data # load packages library(here) library(geomorph) library(tidyverse) library(wesanderson) # read GM data source(&#39;readmulti.csv.R&#39;) setwd(&quot;./data&quot;) filelist &lt;- list.files(pattern = &quot;.csv&quot;) coords &lt;- readmulti.csv(filelist) setwd(&quot;../&quot;) # read qualitative data qdata &lt;- read.csv(&quot;qdata.csv&quot;, header = TRUE, row.names = 1) qdata &lt;- qdata[match(dimnames(coords)[[3]], rownames(qdata)),] 4.2 Generalised Procrustes Analysis Landmark data were aligned to a global coordinate system (Kendall 1981, 1984; Slice 2001), achieved through generalised Procrustes superimposition (Rohlf and Slice 1990) performed in R 4.0.3 (R Core Development Team, 2020) using the geomorph library v. 3.3.2 (Adams et al. 2017; Adams and Otárola-Castillo 2013). Procrustes superimposition translates, scales, and rotates the coordinate data to allow for comparisons among objects (Gower 1975; Rohlf and Slice 1990). The geomorph package uses a partial Procrustes superimposition that projects the aligned specimens into tangent space subsequent to alignment in preparation for the use of multivariate methods that assume linear space (Rohlf 1999; Slice 2001). #select landmarks associated with neck a &lt;- c(1:10, 36:45) # new coords neck neck.coords &lt;- coords[a,,] # gpa Y.gpa &lt;- gpagen(neck.coords, PrinAxes = TRUE, ProcD = TRUE, Proj = TRUE, print.progress = FALSE) # geomorph data frame gdf &lt;- geomorph.data.frame(shape = Y.gpa$coords, size = Y.gpa$Csize, type = qdata$type) # render 3d gpa plot plot(Y.gpa) # gpa plot #knitr::include_graphics(&#39;images/gpa3d.png&#39;) # add centroid size to qdata qdata$csz &lt;- Y.gpa$Csize # print updated qdata with centroid size knitr::kable(qdata, align = &quot;lccccc&quot;, caption = &quot;Modified attributes included in qdata.&quot;) (#tab:gpa.s)Modified attributes included in qdata. group type csz 1608101 phytomorph bottle 107.10572 1608102 phytomorph bottle 142.36178 1608111 anthropomorph jar 163.31036 1608121 phytomorph jar 181.52349 1608122 zoomorph bottle 133.40276 1608124 zoomorph bottle 170.20152 1608125 zoomorph bottle 161.49520 1608126 zoomorph jar 160.22397 1608129 zoomorph jar 134.17259 1608131 zoomorph jar 147.23022 1608140 zoomorph bottle 158.47286 1608141 anthropomorph bottle 75.82197 1608163 zoomorph jar 132.89618 160836 phytomorph bottle 122.71861 160839 zoomorph jar 100.78076 160844 anthropomorph jar 128.53257 160846 zoomorph bottle 138.06314 160847 anthropomorph bottle 124.64438 160848 anthropomorph jar 104.14149 160849 anthropomorph bottle 109.77716 160850 anthropomorph bottle 188.78343 160852 zoomorph bottle 99.79087 160852x anthropomorph jar 139.51302 160859 zoomorph bottle 99.75380 160860 anthropomorph jar 122.83193 160868 zoomorph bottle 175.12810 160873 anthropomorph jar 148.06531 160875 anthropomorph bottle 161.47143 160876 anthropomorph bottle 135.73671 160881 anthropomorph jar 110.56869 160882 zoomorph bottle 143.17329 160884 zoomorph jar 109.99526 160886 zoomorph bottle 109.89164 160888 anthropomorph bottle 119.59953 160892 anthropomorph jar 125.74480 205854 anthropomorph bottle 167.50520 206614 zoomorph jar 118.74759 238944 phytomorph bottle 106.80074 PEX35 zoomorph bottle 174.61464 4.2.1 Boxplot # attributes for boxplot csz &lt;- qdata$csz type &lt;- qdata$type # palette pal &lt;- wes_palette(&quot;Moonrise2&quot;) # boxplot of vessel centroid size by type csz.type &lt;- ggplot(qdata, aes(x = type, y = csz, color = type)) + geom_boxplot(notch = FALSE) + geom_dotplot(binaxis = &#39;y&#39;, stackdir = &#39;center&#39;, dotsize = 0.3) + scale_colour_manual(values = pal) + theme(legend.position = &quot;none&quot;) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) + labs(x = &#39;Type (Neck)&#39;, y = &#39;Centroid Size&#39;) # render plot csz.type ## Bin width defaults to 1/30 of the range of the data. Pick better value with `binwidth`. (#fig:box1.s)Boxplot of centroid size by spatial/temporal unit. 4.3 Principal Components Analysis Principal components analysis (Jolliffe 2002) was used to visualise shape variation among bottle and jar necks. The shape changes described by each principal axis are commonly visualised using thin-plate spline warping of a reference 3D mesh (Klingenberg 2013; Sherratt et al. 2014). # principal components analysis pca&lt;-gm.prcomp(Y.gpa$coords) summary(pca) ## ## Ordination type: Principal Component Analysis ## Centering by OLS mean ## Orthogonal projection of OLS residuals ## Number of observations: 39 ## Number of vectors 36 ## ## Importance of Components: ## Comp1 Comp2 Comp3 Comp4 Comp5 Comp6 Comp7 ## Eigenvalues 0.03652055 0.004064251 0.00108168 0.000638151 0.0003001449 0.0002048617 0.0001070729 ## Proportion of Variance 0.84587966 0.094135151 0.02505360 0.014780690 0.0069518808 0.0047449540 0.0024799941 ## Cumulative Proportion 0.84587966 0.940014813 0.96506842 0.979849107 0.9868009882 0.9915459422 0.9940259363 ## Comp8 Comp9 Comp10 Comp11 Comp12 Comp13 Comp14 ## Eigenvalues 7.173945e-05 0.0000594558 4.209115e-05 1.948601e-05 1.598621e-05 0.0000127950 9.847063e-06 ## Proportion of Variance 1.661611e-03 0.0013771000 9.749044e-04 4.513300e-04 3.702685e-04 0.0002963546 2.280752e-04 ## Cumulative Proportion 9.956875e-01 0.9970646472 9.980396e-01 9.984909e-01 9.988612e-01 0.9991575048 9.993856e-01 ## Comp15 Comp16 Comp17 Comp18 Comp19 Comp20 Comp21 ## Eigenvalues 7.186125e-06 6.069951e-06 3.753207e-06 3.409925e-06 1.825607e-06 1.346814e-06 7.792248e-07 ## Proportion of Variance 1.664432e-04 1.405907e-04 8.693082e-05 7.897980e-05 4.228425e-05 3.119456e-05 1.804821e-05 ## Cumulative Proportion 9.995520e-01 9.996926e-01 9.997795e-01 9.998585e-01 9.999008e-01 9.999320e-01 9.999501e-01 ## Comp22 Comp23 Comp24 Comp25 Comp26 Comp27 Comp28 ## Eigenvalues 6.478865e-07 5.140475e-07 4.433879e-07 1.661079e-07 1.140399e-07 8.823252e-08 6.689052e-08 ## Proportion of Variance 1.500618e-05 1.190624e-05 1.026964e-05 3.847348e-06 2.641362e-06 2.043619e-06 1.549301e-06 ## Cumulative Proportion 9.999651e-01 9.999770e-01 9.999872e-01 9.999911e-01 9.999937e-01 9.999958e-01 9.999973e-01 ## Comp29 Comp30 Comp31 Comp32 Comp33 Comp34 Comp35 ## Eigenvalues 4.468332e-08 2.821632e-08 1.994837e-08 1.246152e-08 7.163238e-09 2.099495e-09 8.060368e-10 ## Proportion of Variance 1.034944e-06 6.535391e-07 4.620390e-07 2.886305e-07 1.659131e-07 4.862797e-08 1.866922e-08 ## Cumulative Proportion 9.999984e-01 9.999990e-01 9.999995e-01 9.999998e-01 9.999999e-01 1.000000e+00 1.000000e+00 ## Comp36 ## Eigenvalues 5.410782e-10 ## Proportion of Variance 1.253232e-08 ## Cumulative Proportion 1.000000e+00 # set plot parameters (types) pch.gps.type &lt;- c(15,17)[as.factor(type)] col.gps.type &lt;- wes_palette(&quot;Moonrise2&quot;)[as.factor(type)] col.hull.type &lt;- c(&quot;#798E87&quot;,&quot;#C27D38&quot;) # plot pca by comb pc.plot.type &lt;- plot(pca, asp = 1, pch = pch.gps.type, col = col.gps.type) shapeHulls(pc.plot.type, groups = type, group.cols = col.hull.type) 4.3.1 Minima/maxima of PC1/2 with warp grids # plot x/y maxima/minima ## x - minima ref &lt;- mean.shape &lt;- mshape(Y.gpa$coords) plotRefToTarget(M1 = ref, M2 = pca$shapes$shapes.comp1$min, method = &quot;TPS&quot;) plotRefToTarget(M1 = ref, M2 = pca$shapes$shapes.comp1$max, method = &quot;TPS&quot;) plotRefToTarget(M1 = ref, M2 = pca$shapes$shapes.comp2$min, method = &quot;TPS&quot;) plotRefToTarget(M1 = ref, M2 = pca$shapes$shapes.comp2$max, method = &quot;TPS&quot;) # pca warp neck knitr::include_graphics(&#39;images/pca-warp-neck.jpg&#39;) (#fig:pca.warp.ne)Results of PCA summarising shape variation in bottle necks, gray; and jar necks, orange; with shapes + warp grids for maxima/minima of each axis. 4.4 Neck size and shape A residual randomisation permutation procedure (RRPP; n = 10,000 permutations) was used for all Procrustes ANOVAs (Adams and Collyer 2015; Michael L. Collyer and Adams 2018), which has higher statistical power and a greater ability to identify patterns in the data should they be present (Anderson and Ter Braak 2003). To assess whether shape changes differ by type (geography and time), Procrustes ANOVAs (Goodall 1991) were also run that enlist effect-sizes (zscores) computed as standard deviates of the generated sampling distributions (M. L. Collyer, Sekora, and Adams 2015). # neck size as a function of vessel form (bottle/jar)? fit.size.type &lt;- procD.lm(size ~ type, data = gdf, print.progress = FALSE, iter = 9999) # Procrustes ANOVA: do neck sizes differ as a function of vessel form? anova(fit.size.type) ## ## Analysis of Variance, using Residual Randomization ## Permutation procedure: Randomization of null model residuals ## Number of permutations: 10000 ## Estimation method: Ordinary Least Squares ## Sums of Squares and Cross-products: Type I ## Effect sizes (Z) based on F distributions ## ## Df SS MS Rsq F Z Pr(&gt;F) ## type 1 79.9 79.87 0.00289 0.1074 -0.67567 0.7381 ## Residuals 37 27524.6 743.91 0.99711 ## Total 38 27604.5 ## ## Call: procD.lm(f1 = size ~ type, iter = 9999, data = gdf, print.progress = FALSE) # neck shape as a function of vessel form? fit.shape.type &lt;- procD.lm(shape ~ type, data = gdf, print.progress = FALSE, iter = 9999) # Procrustes ANOVA: do neck shapes differ as a function of vessel form? anova(fit.shape.type) ## ## Analysis of Variance, using Residual Randomization ## Permutation procedure: Randomization of null model residuals ## Number of permutations: 10000 ## Estimation method: Ordinary Least Squares ## Sums of Squares and Cross-products: Type I ## Effect sizes (Z) based on F distributions ## ## Df SS MS Rsq F Z Pr(&gt;F) ## type 1 0.44899 0.44899 0.27367 13.941 2.8373 5e-04 *** ## Residuals 37 1.19165 0.03221 0.72633 ## Total 38 1.64064 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Call: procD.lm(f1 = shape ~ type, iter = 9999, data = gdf, print.progress = FALSE) 4.5 Mean shapes # subset landmark coordinates to produce mean shapes new.coords&lt;-coords.subset(A = Y.gpa$coords, group = qdata$type) names(new.coords) ## [1] &quot;bottle&quot; &quot;jar&quot; # type shape means mean &lt;- lapply(new.coords, mshape) # plot mean shapes (type) plot(mean$bottle) plot(mean$jar) # comparison plots plotRefToTarget(mean$bottle, mean$jar, method = c(&quot;points&quot;), mag = 1) knitr::include_graphics(&#39;images/mshape-neck.png&#39;) (#fig:mshape.s)Mean shapes for bottles (a), jars (b), and comparison of bottle (gray) and jar (black) neck shapes (c). References "],["dgm-body-morphology.html", "Chapter 5 3DGM: Body morphology 5.1 Load packages + data 5.2 Generalised Procrustes Analysis 5.3 Principal Components Analysis 5.4 Body size and shape", " Chapter 5 3DGM: Body morphology 5.1 Load packages + data # load packages library(here) library(geomorph) library(tidyverse) library(wesanderson) # read GM data source(&#39;readmulti.csv.R&#39;) setwd(&quot;./data&quot;) filelist &lt;- list.files(pattern = &quot;.csv&quot;) coords &lt;- readmulti.csv(filelist) setwd(&quot;../&quot;) # read qualitative data qdata &lt;- read.csv(&quot;qdata.csv&quot;, header = TRUE, row.names = 1) qdata &lt;- qdata[match(dimnames(coords)[[3]], rownames(qdata)),] 5.2 Generalised Procrustes Analysis Landmark data were aligned to a global coordinate system (Kendall 1981, 1984; Slice 2001), achieved through generalised Procrustes superimposition (Rohlf and Slice 1990) performed in R 4.0.3 (R Core Development Team, 2020) using the geomorph library v. 3.3.2 (Adams et al. 2017; Adams and Otárola-Castillo 2013). Procrustes superimposition translates, scales, and rotates the coordinate data to allow for comparisons among objects (Gower 1975; Rohlf and Slice 1990). The geomorph package uses a partial Procrustes superimposition that projects the aligned specimens into tangent space subsequent to alignment in preparation for the use of multivariate methods that assume linear space (Rohlf 1999; Slice 2001). #select landmarks associated with body b &lt;- c(10:36) # new coords body body.coords &lt;- coords[b,,] # gpa Y.gpa &lt;- gpagen(body.coords, PrinAxes = TRUE, ProcD = TRUE, Proj = TRUE, print.progress = FALSE) # geomorph data frame gdf &lt;- geomorph.data.frame(shape = Y.gpa$coords, size = Y.gpa$Csize, type = qdata$type) # render 3d gpa plot #plot(Y.gpa) # gpa plot #knitr::include_graphics(&#39;images/gpa3d.png&#39;) # add centroid size to qdata qdata$csz &lt;- Y.gpa$Csize # print updated qdata with centroid size knitr::kable(qdata, align = &quot;lccccc&quot;, caption = &quot;Modified attributes included in qdata.&quot;) (#tab:gpa.b)Modified attributes included in qdata. group type csz 1608101 phytomorph bottle 306.5908 1608102 phytomorph bottle 428.6295 1608111 anthropomorph jar 379.2348 1608121 phytomorph jar 460.0918 1608122 zoomorph bottle 390.3755 1608124 zoomorph bottle 363.4746 1608125 zoomorph bottle 369.0941 1608126 zoomorph jar 404.7957 1608129 zoomorph jar 362.7992 1608131 zoomorph jar 459.3876 1608140 zoomorph bottle 366.3428 1608141 anthropomorph bottle 357.6123 1608163 zoomorph jar 302.5793 160836 phytomorph bottle 356.0759 160839 zoomorph jar 266.9075 160844 anthropomorph jar 385.2605 160846 zoomorph bottle 372.7675 160847 anthropomorph bottle 283.2789 160848 anthropomorph jar 322.4210 160849 anthropomorph bottle 319.1380 160850 anthropomorph bottle 497.0387 160852 zoomorph bottle 364.1463 160852x anthropomorph jar 403.7583 160859 zoomorph bottle 364.3419 160860 anthropomorph jar 302.9424 160868 zoomorph bottle 450.7841 160873 anthropomorph jar 391.0479 160875 anthropomorph bottle 460.7270 160876 anthropomorph bottle 392.1549 160881 anthropomorph jar 262.3381 160882 zoomorph bottle 363.3798 160884 zoomorph jar 259.7315 160886 zoomorph bottle 282.7665 160888 anthropomorph bottle 255.7410 160892 anthropomorph jar 261.3935 205854 anthropomorph bottle 214.7645 206614 zoomorph jar 304.4250 238944 phytomorph bottle 480.9831 PEX35 zoomorph bottle 447.8055 5.2.1 Boxplot # attributes for boxplot csz &lt;- qdata$csz type &lt;- qdata$type # palette pal &lt;- wes_palette(&quot;Moonrise2&quot;) # boxplot of vessel centroid size by type csz.type &lt;- ggplot(qdata, aes(x = type, y = csz, color = type)) + geom_boxplot(notch = FALSE) + geom_dotplot(binaxis = &#39;y&#39;, stackdir = &#39;center&#39;, dotsize = 0.3) + scale_colour_manual(values = pal) + theme(legend.position = &quot;none&quot;) + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) + labs(x = &#39;Type (Body)&#39;, y = &#39;Centroid Size&#39;) # render plot csz.type ## Bin width defaults to 1/30 of the range of the data. Pick better value with `binwidth`. (#fig:box1.b)Boxplot of centroid size by spatial/temporal unit. 5.3 Principal Components Analysis Principal components analysis (Jolliffe 2002) was used to visualise shape variation among bottle and jar necks. The shape changes described by each principal axis are commonly visualised using thin-plate spline warping of a reference 3D mesh (Klingenberg 2013; Sherratt et al. 2014). # principal components analysis pca&lt;-gm.prcomp(Y.gpa$coords) summary(pca) ## ## Ordination type: Principal Component Analysis ## Centering by OLS mean ## Orthogonal projection of OLS residuals ## Number of observations: 39 ## Number of vectors 38 ## ## Importance of Components: ## Comp1 Comp2 Comp3 Comp4 Comp5 Comp6 Comp7 ## Eigenvalues 0.007458882 0.001885411 0.0006182644 0.0001779389 0.0001184379 8.062445e-05 4.228582e-05 ## Proportion of Variance 0.709682647 0.179389249 0.0588253728 0.0169301698 0.0112688883 7.671092e-03 4.023326e-03 ## Cumulative Proportion 0.709682647 0.889071896 0.9478972691 0.9648274388 0.9760963272 9.837674e-01 9.877907e-01 ## Comp8 Comp9 Comp10 Comp11 Comp12 Comp13 Comp14 ## Eigenvalues 3.541659e-05 2.283498e-05 1.608011e-05 1.302033e-05 9.479455e-06 7.538156e-06 5.215682e-06 ## Proportion of Variance 3.369746e-03 2.172656e-03 1.529958e-03 1.238832e-03 9.019320e-04 7.172252e-04 4.962512e-04 ## Cumulative Proportion 9.911605e-01 9.933331e-01 9.948631e-01 9.961019e-01 9.970039e-01 9.977211e-01 9.982173e-01 ## Comp15 Comp16 Comp17 Comp18 Comp19 Comp20 Comp21 ## Eigenvalues 3.738479e-06 3.043912e-06 2.460653e-06 2.071184e-06 1.540457e-06 1.343188e-06 1.048328e-06 ## Proportion of Variance 3.557013e-04 2.896160e-04 2.341212e-04 1.970648e-04 1.465683e-04 1.277989e-04 9.974419e-05 ## Cumulative Proportion 9.985730e-01 9.988627e-01 9.990968e-01 9.992938e-01 9.994404e-01 9.995682e-01 9.996680e-01 ## Comp22 Comp23 Comp24 Comp25 Comp26 Comp27 Comp28 ## Eigenvalues 8.217409e-07 6.299542e-07 5.490204e-07 4.099150e-07 2.974149e-07 2.479554e-07 1.467824e-07 ## Proportion of Variance 7.818534e-05 5.993761e-05 5.223708e-05 3.900176e-05 2.829783e-05 2.359196e-05 1.396575e-05 ## Cumulative Proportion 9.997461e-01 9.998061e-01 9.998583e-01 9.998973e-01 9.999256e-01 9.999492e-01 9.999632e-01 ## Comp29 Comp30 Comp31 Comp32 Comp33 Comp34 Comp35 ## Eigenvalues 1.201451e-07 1.089863e-07 5.707287e-08 4.161217e-08 2.015203e-08 1.830940e-08 1.214451e-08 ## Proportion of Variance 1.143132e-05 1.036961e-05 5.430254e-06 3.959230e-06 1.917384e-06 1.742066e-06 1.155501e-06 ## Cumulative Proportion 9.999746e-01 9.999850e-01 9.999904e-01 9.999944e-01 9.999963e-01 9.999980e-01 9.999992e-01 ## Comp36 Comp37 Comp38 ## Eigenvalues 5.210013e-09 3.131586e-09 2.403326e-10 ## Proportion of Variance 4.957118e-07 2.979579e-07 2.286669e-08 ## Cumulative Proportion 9.999997e-01 1.000000e+00 1.000000e+00 # set plot parameters (types) pch.gps.type &lt;- c(15,17)[as.factor(type)] col.gps.type &lt;- wes_palette(&quot;Moonrise2&quot;)[as.factor(type)] col.hull.type &lt;- c(&quot;#798E87&quot;,&quot;#C27D38&quot;) # plot pca by comb pc.plot.type &lt;- plot(pca, asp = 1, pch = pch.gps.type, col = col.gps.type) shapeHulls(pc.plot.type, groups = type, group.cols = col.hull.type) 5.3.1 Minima/maxima of PC1/2 with warp grids # plot x/y maxima/minima ## x - minima ref &lt;- mean.shape &lt;- mshape(Y.gpa$coords) plotRefToTarget(M1 = ref, M2 = pca$shapes$shapes.comp1$min, method = &quot;TPS&quot;) plotRefToTarget(M1 = ref, M2 = pca$shapes$shapes.comp1$max, method = &quot;TPS&quot;) plotRefToTarget(M1 = ref, M2 = pca$shapes$shapes.comp2$min, method = &quot;TPS&quot;) plotRefToTarget(M1 = ref, M2 = pca$shapes$shapes.comp2$max, method = &quot;TPS&quot;) # pca warp body knitr::include_graphics(&#39;images/pca-warp-body.jpg&#39;) (#fig:pca.warp.bo)Results of PCA summarising shape variation in bottle bodies, gray; and jar bodies, orange; with shapes + warp grids for maxima/minima of each axis. 5.4 Body size and shape A residual randomisation permutation procedure (RRPP; n = 10,000 permutations) was used for all Procrustes ANOVAs (Adams and Collyer 2015; Michael L. Collyer and Adams 2018), which has higher statistical power and a greater ability to identify patterns in the data should they be present (Anderson and Ter Braak 2003). To assess whether shape changes differ by type (geography and time), Procrustes ANOVAs (Goodall 1991) were also run that enlist effect-sizes (zscores) computed as standard deviates of the generated sampling distributions (M. L. Collyer, Sekora, and Adams 2015). # body size as a function of vessel form (bottle/jar)? fit.size.type &lt;- procD.lm(size ~ type, data = gdf, print.progress = FALSE, iter = 9999) # Procrustes ANOVA: do body sizes differ as a function of vessel form? anova(fit.size.type) ## ## Analysis of Variance, using Residual Randomization ## Permutation procedure: Randomization of null model residuals ## Number of permutations: 10000 ## Estimation method: Ordinary Least Squares ## Sums of Squares and Cross-products: Type I ## Effect sizes (Z) based on F distributions ## ## Df SS MS Rsq F Z Pr(&gt;F) ## type 1 5200 5199.6 0.02741 1.0427 0.54424 0.3111 ## Residuals 37 184503 4986.6 0.97259 ## Total 38 189703 ## ## Call: procD.lm(f1 = size ~ type, iter = 9999, data = gdf, print.progress = FALSE) # body shape as a function of vessel form? fit.shape.type &lt;- procD.lm(shape ~ type, data = gdf, print.progress = FALSE, iter = 9999) # Procrustes ANOVA: do body shapes differ as a function of vessel form? anova(fit.shape.type) ## ## Analysis of Variance, using Residual Randomization ## Permutation procedure: Randomization of null model residuals ## Number of permutations: 10000 ## Estimation method: Ordinary Least Squares ## Sums of Squares and Cross-products: Type I ## Effect sizes (Z) based on F distributions ## ## Df SS MS Rsq F Z Pr(&gt;F) ## type 1 0.02825 0.028250 0.07073 2.8163 1.5108 0.0659 . ## Residuals 37 0.37114 0.010031 0.92927 ## Total 38 0.39939 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Call: procD.lm(f1 = shape ~ type, iter = 9999, data = gdf, print.progress = FALSE) References "],["vessel-forms-and-elements.html", "Chapter 6 Vessel Forms and Elements 6.1 Load packages + data 6.2 Generalised Procrustes Analysis 6.3 Principal Components Analysis 6.4 Vessel size and shape 6.5 Morphological disparity 6.6 Mean shapes", " Chapter 6 Vessel Forms and Elements 6.1 Load packages + data # load packages #devtools::install_github(&quot;mlcollyer/RRPP&quot;) #devtools::install_github(&quot;geomorphR/geomorph&quot;, ref = &quot;Stable&quot;, build_vignettes = TRUE) library(here) library(geomorph) library(tidyverse) library(wesanderson) # read GM data source(&#39;readmulti.csv.R&#39;) setwd(&quot;./data2&quot;) filelist &lt;- list.files(pattern = &quot;.csv&quot;) coords &lt;- readmulti.csv(filelist) setwd(&quot;../&quot;) # read qualitative data qdata &lt;- read.csv(&quot;qdata.csv&quot;, header = TRUE, row.names = 1) qdata &lt;- qdata[match(dimnames(coords)[[3]], rownames(qdata)),] qdata &lt;- qdata %&gt;% unite(&quot;merged&quot;, group:type, remove = FALSE) # exclude phytomorph - need multiples # result = analysis will compare bottles and jars adorned with anthropomorph # and zoomorph decorative elements qdata &lt;- filter(qdata, group != &quot;phytomorph&quot;) 6.2 Generalised Procrustes Analysis Landmark data were aligned to a global coordinate system (Kendall 1981, 1984; Slice 2001), achieved through generalised Procrustes superimposition (Rohlf and Slice 1990) performed in R 4.0.3 (R Core Development Team, 2020) using the geomorph library v. 3.3.2 (Adams et al. 2017; Adams and Otárola-Castillo 2013). Procrustes superimposition translates, scales, and rotates the coordinate data to allow for comparisons among objects (Gower 1975; Rohlf and Slice 1990). The geomorph package uses a partial Procrustes superimposition that projects the aligned specimens into tangent space subsequent to alignment in preparation for the use of multivariate methods that assume linear space (Rohlf 1999; Slice 2001). # gpa Y.gpa &lt;- gpagen(coords, PrinAxes = TRUE, ProcD = TRUE, Proj = TRUE, print.progress = FALSE) # geomorph data frame gdf &lt;- geomorph.data.frame(shape = Y.gpa$coords, size = Y.gpa$Csize, merged = qdata$merged) # render 3d gpa plot #plot(Y.gpa) # gpa plot #knitr::include_graphics(&#39;images/gpa3d.png&#39;) # add centroid size to qdata qdata$csz &lt;- Y.gpa$Csize # print updated qdata with centroid size knitr::kable(qdata, align = &quot;lccccc&quot;, caption = &quot;Modified attributes included in qdata.&quot;) Table 6.1: Modified attributes included in qdata. merged group type csz 1608111 anthropomorph_jar anthropomorph jar 585.9878 1608122 zoomorph_bottle zoomorph bottle 578.2339 1608124 zoomorph_bottle zoomorph bottle 543.0810 1608125 zoomorph_bottle zoomorph bottle 538.4608 1608126 zoomorph_jar zoomorph jar 613.1277 1608129 zoomorph_jar zoomorph jar 511.8743 1608131 zoomorph_jar zoomorph jar 681.0963 1608140 zoomorph_bottle zoomorph bottle 558.2951 1608141 anthropomorph_bottle anthropomorph bottle 511.1698 1608163 zoomorph_jar zoomorph jar 432.3418 160839 zoomorph_jar zoomorph jar 416.4591 160844 anthropomorph_jar anthropomorph jar 607.4952 160846 zoomorph_bottle zoomorph bottle 545.1291 160847 anthropomorph_bottle anthropomorph bottle 416.4516 160848 anthropomorph_jar anthropomorph jar 468.6945 160849 anthropomorph_bottle anthropomorph bottle 453.0625 160850 anthropomorph_bottle anthropomorph bottle 751.5635 160852 zoomorph_bottle zoomorph bottle 512.1550 160852x anthropomorph_jar anthropomorph jar 596.2446 160859 zoomorph_bottle zoomorph bottle 512.3332 160860 anthropomorph_jar anthropomorph jar 449.6768 160868 zoomorph_bottle zoomorph bottle 674.0455 160873 anthropomorph_jar anthropomorph jar 590.1911 160875 anthropomorph_bottle anthropomorph bottle 687.1416 160876 anthropomorph_bottle anthropomorph bottle 591.4190 160881 anthropomorph_jar anthropomorph jar 416.0126 160882 zoomorph_bottle zoomorph bottle 544.4697 160884 zoomorph_jar zoomorph jar 418.5339 160886 zoomorph_bottle zoomorph bottle 441.5053 160888 anthropomorph_bottle anthropomorph bottle 379.4152 160892 anthropomorph_jar anthropomorph jar 384.3096 205854 anthropomorph_bottle anthropomorph bottle 407.5996 206614 zoomorph_jar zoomorph jar 458.8122 PEX35 zoomorph_bottle zoomorph bottle 635.8740 6.2.1 Boxplot # attributes for boxplot csz &lt;- qdata$csz merged &lt;- qdata$merged pal &lt;- wes_palette(&quot;Moonrise2&quot;) # boxplot of vessel centroid size by merged csz.type &lt;- ggplot(qdata, aes(x = merged, y = csz, color = merged)) + geom_boxplot() + geom_dotplot(binaxis = &#39;y&#39;, stackdir = &#39;center&#39;, dotsize = 0.3) + scale_colour_manual(values = pal) + theme(legend.position = &quot;none&quot;) + theme(axis.text.x = element_text(angle = 90, vjust = 1, hjust=1)) + labs(x = &#39;Group&#39;, y = &#39;Centroid Size&#39;) # render plot csz.type ## Bin width defaults to 1/30 of the range of the data. Pick better value with `binwidth`. Figure 6.1: Boxplot of centroid size by spatial/temporal unit. 6.3 Principal Components Analysis Principal components analysis (Jolliffe 2002) was used to visualise shape variation among the bottles. The shape changes described by each principal axis are commonly visualised using thin-plate spline warping of a reference 3D mesh (Klingenberg 2013; Sherratt et al. 2014). # principal components analysis pca&lt;-gm.prcomp(Y.gpa$coords) summary(pca) ## ## Ordination type: Principal Component Analysis ## Centering by OLS mean ## Orthogonal projection of OLS residuals ## Number of observations: 34 ## Number of vectors 33 ## ## Importance of Components: ## Comp1 Comp2 Comp3 Comp4 Comp5 Comp6 Comp7 ## Eigenvalues 0.004439028 0.003520131 0.001348467 0.0005801858 0.0003425897 0.0002534948 8.618724e-05 ## Proportion of Variance 0.409390736 0.324645238 0.124362781 0.0535078173 0.0315954425 0.0233786351 7.948645e-03 ## Cumulative Proportion 0.409390736 0.734035974 0.858398756 0.9119065730 0.9435020155 0.9668806506 9.748293e-01 ## Comp8 Comp9 Comp10 Comp11 Comp12 Comp13 Comp14 ## Eigenvalues 6.058338e-05 5.117651e-05 3.249072e-05 3.151383e-05 2.038198e-05 1.554888e-05 1.396917e-05 ## Proportion of Variance 5.587321e-03 4.719770e-03 2.996467e-03 2.906373e-03 1.879735e-03 1.434000e-03 1.288311e-03 ## Cumulative Proportion 9.804166e-01 9.851364e-01 9.881329e-01 9.910392e-01 9.929190e-01 9.943530e-01 9.956413e-01 ## Comp15 Comp16 Comp17 Comp18 Comp19 Comp20 Comp21 ## Eigenvalues 9.829685e-06 6.900759e-06 6.314543e-06 5.290447e-06 3.999721e-06 3.406899e-06 2.308270e-06 ## Proportion of Variance 9.065458e-04 6.364247e-04 5.823607e-04 4.879131e-04 3.688755e-04 3.142024e-04 2.128810e-04 ## Cumulative Proportion 9.965478e-01 9.971842e-01 9.977666e-01 9.982545e-01 9.986234e-01 9.989376e-01 9.991505e-01 ## Comp22 Comp23 Comp24 Comp25 Comp26 Comp27 Comp28 ## Eigenvalues 1.778245e-06 1.496719e-06 1.226482e-06 1.215542e-06 9.279665e-07 8.528053e-07 5.825998e-07 ## Proportion of Variance 1.639992e-04 1.380354e-04 1.131127e-04 1.121037e-04 8.558201e-05 7.865023e-05 5.373045e-05 ## Cumulative Proportion 9.993145e-01 9.994525e-01 9.995656e-01 9.996777e-01 9.997633e-01 9.998420e-01 9.998957e-01 ## Comp29 Comp30 Comp31 Comp32 Comp33 ## Eigenvalues 4.147759e-07 3.276474e-07 2.311869e-07 1.530809e-07 4.355478e-09 ## Proportion of Variance 3.825284e-05 3.021738e-05 2.132129e-05 1.411793e-05 4.016853e-07 ## Cumulative Proportion 9.999339e-01 9.999642e-01 9.999855e-01 9.999996e-01 1.000000e+00 # set plot parameters (types) pch.gps.type &lt;- c(0:3)[as.factor(merged)] col.gps.type &lt;- pal[as.factor(merged)] col.hull.type &lt;- c(&quot;#C27D38&quot;,&quot;#CCC591&quot;,&quot;#29211F&quot;,&quot;#798E87&quot;) # plot pca by comb pc.plot.type &lt;- plot(pca, asp = 1, pch = pch.gps.type, col = col.gps.type) shapeHulls(pc.plot.type, groups = merged, group.cols = col.hull.type) 6.3.1 Minima/maxima of PC1/2 with warp grids # plot x/y maxima/minima ## x - minima ref &lt;- mean.shape &lt;- mshape(Y.gpa$coords) plotRefToTarget(M1 = ref, M2 = pca$shapes$shapes.comp1$min, method = &quot;TPS&quot;) plotRefToTarget(M1 = ref, M2 = pca$shapes$shapes.comp1$max, method = &quot;TPS&quot;) plotRefToTarget(M1 = ref, M2 = pca$shapes$shapes.comp2$min, method = &quot;TPS&quot;) plotRefToTarget(M1 = ref, M2 = pca$shapes$shapes.comp2$max, method = &quot;TPS&quot;) # pca warp #knitr::include_graphics(&#39;images/pca-warp-botjar.jpg&#39;) 6.4 Vessel size and shape A residual randomisation permutation procedure (RRPP; n = 10,000 permutations) was used for all Procrustes ANOVAs (Adams and Collyer 2015; Michael L. Collyer and Adams 2018), which has higher statistical power and a greater ability to identify patterns in the data should they be present (Anderson and Ter Braak 2003). To assess whether shape changes differ by group (geography and time), Procrustes ANOVAs (Goodall 1991) were also run that enlist effect-sizes (zscores) computed as standard deviates of the generated sampling distributions (M. L. Collyer, Sekora, and Adams 2015). # size as a function of merged? fit.size.merged &lt;- procD.lm(size ~ merged, data = gdf, print.progress = FALSE, iter = 9999) # Procrustes ANOVA: do sizes differ? anova(fit.size.merged) ## ## Analysis of Variance, using Residual Randomization ## Permutation procedure: Randomization of null model residuals ## Number of permutations: 10000 ## Estimation method: Ordinary Least Squares ## Sums of Squares and Cross-products: Type I ## Effect sizes (Z) based on F distributions ## ## Df SS MS Rsq F Z Pr(&gt;F) ## merged 3 12739 4246.5 0.04112 0.4288 -0.6227 0.7315 ## Residuals 30 297099 9903.3 0.95888 ## Total 33 309838 ## ## Call: procD.lm(f1 = size ~ merged, iter = 9999, data = gdf, print.progress = FALSE) # shape as a function of merged? fit.shape.merged &lt;- procD.lm(shape ~ merged, data = gdf, print.progress = FALSE, iter = 9999) # Procrustes ANOVA: do shapes differ? anova(fit.shape.merged) ## ## Analysis of Variance, using Residual Randomization ## Permutation procedure: Randomization of null model residuals ## Number of permutations: 10000 ## Estimation method: Ordinary Least Squares ## Sums of Squares and Cross-products: Type I ## Effect sizes (Z) based on F distributions ## ## Df SS MS Rsq F Z Pr(&gt;F) ## merged 3 0.04367 0.014556 0.12204 1.3901 0.94034 0.1751 ## Residuals 30 0.31415 0.010472 0.87796 ## Total 33 0.35782 ## ## Call: procD.lm(f1 = shape ~ merged, iter = 9999, data = gdf, print.progress = FALSE) 6.5 Morphological disparity # morphological disparity: do either of the groups display greater # size variation among individuals relative to the other group? morphol.disparity(fit.size.merged, groups = qdata$merged, data = gdf, print.progress = FALSE, iter = 9999) ## ## Call: ## morphol.disparity(f1 = fit.size.merged, groups = qdata$merged, iter = 9999, data = gdf, print.progress = FALSE) ## ## ## ## ## Randomized Residual Permutation Procedure Used ## 10000 Permutations ## ## Procrustes variances for defined groups ## anthropomorph_bottle anthropomorph_jar zoomorph_bottle zoomorph_jar ## 16769.826 7385.205 3489.322 9353.729 ## ## ## Pairwise absolute differences between variances ## anthropomorph_bottle anthropomorph_jar zoomorph_bottle zoomorph_jar ## anthropomorph_bottle 0.000 9384.621 13280.504 7416.098 ## anthropomorph_jar 9384.621 0.000 3895.883 1968.524 ## zoomorph_bottle 13280.504 3895.883 0.000 5864.407 ## zoomorph_jar 7416.098 1968.524 5864.407 0.000 ## ## ## P-Values ## anthropomorph_bottle anthropomorph_jar zoomorph_bottle zoomorph_jar ## anthropomorph_bottle 1.0000 0.0799 0.0036 0.1950 ## anthropomorph_jar 0.0799 1.0000 0.4540 0.7411 ## zoomorph_bottle 0.0036 0.4540 1.0000 0.2734 ## zoomorph_jar 0.1950 0.7411 0.2734 1.0000 # morphological disparity: do either of the groups display greater #shape variation among individuals relative to the other group? morphol.disparity(fit.shape.merged, groups = qdata$merged, data = gdf, print.progress = FALSE, iter = 9999) ## ## Call: ## morphol.disparity(f1 = fit.shape.merged, groups = qdata$merged, iter = 9999, data = gdf, print.progress = FALSE) ## ## ## ## ## Randomized Residual Permutation Procedure Used ## 10000 Permutations ## ## Procrustes variances for defined groups ## anthropomorph_bottle anthropomorph_jar zoomorph_bottle zoomorph_jar ## 0.018351301 0.006762281 0.005859067 0.006970319 ## ## ## Pairwise absolute differences between variances ## anthropomorph_bottle anthropomorph_jar zoomorph_bottle zoomorph_jar ## anthropomorph_bottle 0.00000000 0.0115890197 0.0124922345 0.011380982 ## anthropomorph_jar 0.01158902 0.0000000000 0.0009032148 0.000208038 ## zoomorph_bottle 0.01249223 0.0009032148 0.0000000000 0.001111253 ## zoomorph_jar 0.01138098 0.0002080380 0.0011112528 0.000000000 ## ## ## P-Values ## anthropomorph_bottle anthropomorph_jar zoomorph_bottle zoomorph_jar ## anthropomorph_bottle 1.0000 0.0611 0.0145 0.0976 ## anthropomorph_jar 0.0611 1.0000 0.8652 0.9655 ## zoomorph_bottle 0.0145 0.8652 1.0000 0.8354 ## zoomorph_jar 0.0976 0.9655 0.8354 1.0000 6.6 Mean shapes # subset landmark coordinates to produce mean shapes new.coords&lt;-coords.subset(A = Y.gpa$coords, group = qdata$merged) names(new.coords) ## [1] &quot;anthropomorph_bottle&quot; &quot;anthropomorph_jar&quot; &quot;zoomorph_bottle&quot; &quot;zoomorph_jar&quot; # group shape means mean &lt;- lapply(new.coords, mshape) # plot mean shapes (type) plot(mean$anthropomorph_bottle) plot(mean$anthropomorph_jar) plot(mean$zoomorph_bottle) plot(mean$zoomorph_jar) # comparison plots plotRefToTarget(mean$anthropomorph_bottle, mean$zoomorph_bottle, method = c(&quot;points&quot;), mag = 1) plotRefToTarget(mean$anthropomorph_jar, mean$zoomorph_jar, method = c(&quot;points&quot;), mag = 1) #knitr::include_graphics(&#39;images/mshape.png&#39;) References "],["references.html", "References", " References "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
